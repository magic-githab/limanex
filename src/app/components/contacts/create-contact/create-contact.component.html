<ngx-smart-modal [closable]="false" #createContact identifier="createContact">
  <div class="modal-wrapper">
    <header>
      <h2>
        {{ 'contacts.create.title' | translate }}
      </h2>
      <fa-icon class="close" [icon]="['fas', 'times']" (click)="createContact.close()"></fa-icon>
    </header>

    <form [formGroup]="createContactForm" (ngSubmit)="onSubmit()">
      <div class="wrapper">
        <div class="input-wrapper">
          <input type="text" [placeholder]="'contacts.create.firstNamePlaceholder' | translate"
            formControlName="firstName" />
          <label for="">{{ 'contacts.create.name' | translate }}</label>
        </div>
        <div class="input-wrapper">
          <input type="text" [placeholder]="'contacts.create.lastNamePlaceholder' | translate"
            formControlName="lastName" />
        </div>
        <div class="input-wrapper">
          <input type="text" [placeholder]="'contacts.create.fullNamePlaceholder' | translate"
            formControlName="hebName" />
        </div>

        <div formArrayName="phones" *ngFor="
            let phoneControl of createContactForm.get('phones')['controls'];
            let i = index
          ">
          <div [formGroupName]="i">
            <div class="input-wrapper">
              <div class="phone-input-wrapper">
                <ng-autocomplete #auto [data]="filteredPhoneCodes" [itemTemplate]="itemTemplate"
                  [notFoundTemplate]="notFoundTemplate" [isLoading]="isPhonesLoading"
                  (inputChanged)="filterPhoneCodes($event)" formControlName="prefix">
                </ng-autocomplete>
                <input type="text" formControlName="phone" />
              </div>
              <label for="">{{ 'contacts.create.phone' | translate }}</label>
            </div>

            <div class="radio-buttons" formArrayName="platforms" *ngFor="
                let platformControl of phoneControl.get('platforms')['controls'];
                let j = index
              ">
              <div class="radio" *ngFor="let platform of platforms">
                <label>
                  <input type="radio" name="platforms" [value]="platform" [formControlName]="j" />
                  <span>
                    <fa-icon [icon]="['fas', 'check']"></fa-icon>
                  </span>
                </label>
                <fa-icon [class]="platform" [icon]="['fab', platform]"></fa-icon>
              </div>
            </div>
          </div>
        </div>

        <div class="input-wrapper">
          <input type="text" formControlName="email" />
          <label for="">{{ 'contacts.create.email' | translate }}</label>
        </div>
      </div>

      <div class="buttons">
        <button type="button" (click)="closeModal()">
          {{ 'contacts.create.cancel' | translate }}
        </button>
        <button [ngClass]="{ disabled: createContactForm.invalid }" [ngSwitch]="isCreateLoading">
          <span *ngSwitchCase="false">{{
            'contacts.create.submit' | translate
          }}</span>
          <fa-icon *ngSwitchCase="true" [icon]="['fas', 'spinner']" [spin]="true"></fa-icon>
        </button>
      </div>
    </form>
  </div>
</ngx-smart-modal>

<ng-template #itemTemplate let-item>
  <a [innerHTML]="item"></a>
</ng-template>

<ng-template #notFoundTemplate let-notFound>
  <div [innerHTML]="notFound"></div>
</ng-template>
