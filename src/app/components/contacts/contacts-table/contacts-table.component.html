<ngx-datatable #ngxTable class="bootstrap" [rows]="contacts$ | async" rowHeight="auto" columnMode="force"
  footerHeight="auto" (activate)="onActivate($event)">

  <!-- Column Templates -->
  <ngx-datatable-column [width]="25" [resizeable]="false" [canAutoResize]="false">
    <ng-template let-expanded="expanded" ngx-datatable-cell-template>
      <a href="javascript:void(0)" class="arrow" title="Expand/Collapse Row" [class.datatable-icon-right]="!expanded"
        [class.datatable-icon-down]="expanded">
      </a>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column [name]="'contacts.table.name' | translate" [sortable]="false">
    <ng-template let-contact="row" ngx-datatable-cell-template>
      <span class="text-primary">{{ contact.name | titlecase }}</span>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column [name]="'contacts.table.address' | translate" [sortable]="false" *ngIf="showAddress">
    <ng-template let-column="column" ngx-datatable-header-template>
      <span>{{ column.name }}</span>
    </ng-template>

    <ng-template let-address="value" ngx-datatable-cell-template>
      <p>{{ address.cityName | titlecase }}</p>
      <p>{{ address.street | titlecase }}</p>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-column [name]="'contacts.table.roles' | translate" [sortable]="false">
    <ng-template let-contact="row" ngx-datatable-cell-template>
      <span *ngFor="let role of contact.roles | keyvalue" class="badge badge-secondary mr-1">
        {{ role.key | titlecase }}
      </span>
    </ng-template>
  </ngx-datatable-column>

  <ngx-datatable-footer>
    <ng-template ngx-datatable-footer-template let-rowCount="rowCount">
      {{ 'contacts.table.entires' | translate }}
      {{ rowCount }}
      <fa-icon *ngIf="isLoading$ | async" [icon]="['fas', 'spinner']" [spin]="true"></fa-icon>
    </ng-template>
  </ngx-datatable-footer>

  <!-- Row Detail Template -->
  <ngx-datatable-row-detail rowHeight="auto">
    <ng-template let-contact="row" ngx-datatable-row-detail-template>
      <div>
        <p>{{ 'contacts.table.info' | translate }}:</p>
        <div>
          <p class="phone" *ngIf="contact.phones.length">
            <fa-icon [icon]="['fas', 'phone']"></fa-icon>
            <span *ngFor="let phone of contact.phones">{{ phone.prefix }}{{ phone.phone }}</span>
          </p>
          <p *ngIf="contact.email">
            <fa-icon [icon]="['far', 'envelope']"></fa-icon>
            <span>{{ contact.email }}</span>
          </p>
        </div>
      </div>

      <div class="address" *ngIf="!showAddress">
        <p>{{ 'contacts.table.address' | translate }}:</p>
        <div>
          <p class="city">{{ contact.address.cityName | titlecase }}</p>
          <p class="street">{{ contact.address.street | titlecase }}</p>
        </div>
      </div>

      <div>
        <p>{{ 'contacts.table.id' | translate }}:</p>
        <div>
          <p class="id">
            <span>{{ contact.uniqueCode }}</span>
          </p>
        </div>
      </div>

      <div>
        <p>{{ 'contacts.table.added' | translate }}:</p>
        <div>
          <p>
            {{ contact.insertBy.name }} |
            {{ contact.timestamp.date | date: 'dd/MM/yyyy HH:mm ' }}
          </p>
        </div>
      </div>
    </ng-template>
  </ngx-datatable-row-detail>

</ngx-datatable>
